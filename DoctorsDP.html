<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="chatbot.css">

  <meta charset="UTF-8">
  <title>Our Doctors â€“ Smile Clinic</title>
  <link rel="stylesheet" href="DentalProject.css">

  <!-- React CDN -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
</head>
<body>

<nav class="navbar">
  <div class="logo">SMILE CLINIC </div>
  <ul class="nav-links">
    <li><a href="index.html">Home </a></li>
    <li><a href="DoctorsDP.html" class="active">Our Doctors </a></li>
    <li><a href="ServiceDP.html">Our Services </a></li>
    <li><a href="EmergencyDP.html" class="emergency-btn">Emergency </a></li>
    <li><a href="BookingDP.html">Book Now </a></li>
   <li><a href="HistoryDP.html">Patient History </a></li>
  </ul>
</nav>

<section class="doctors-page">
  <h1> Meet Our Specialist Team</h1>

  <!-- Single React Container -->
  <div id="doctors-app"></div>
</section>

<script>
  const e = React.createElement;
  const { useState, useEffect } = React;
  const API_URL = (function resolveApiBase() {
    if (window.API_BASE_URL) {
      return window.API_BASE_URL.replace(/\/$/, '');
    }
    const { protocol, hostname, port, origin } = window.location;
    const isLocalhost = hostname === 'localhost' || hostname === '127.0.0.1';
    if (protocol === 'file:' || !hostname) {
      return 'http://localhost:3000/api';
    }
    if (isLocalhost) {
      const resolvedPort = port || '3000';
      return `${protocol}//${hostname}:${resolvedPort}/api`;
    }
    return `${origin.replace(/\/$/, '')}/api`;
  })();

  const defaultDoctorPhoto = 'https://images.unsplash.com/photo-1521572267360-ee0c2909d518?auto=format&fit=crop&w=420&q=80';
  const doctorPhotos = {
    'Dr. Ahmed Amer': 'https://images.unsplash.com/photo-1504593811423-6dd665756598?auto=format&fit=crop&w=420&q=80',
    'Dr. Sarah Hany': 'https://images.unsplash.com/photo-1544723795-3fb6469f5b39?auto=format&fit=crop&w=420&q=80',
    'Dr. Youmna Galeb': 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=420&q=80',
    'Dr. Mai Mansour': 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=420&q=80',
    'Dr. Youssef Kamel': 'https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?auto=format&fit=crop&w=420&q=80'
  };
  const resolveDoctorImage = (doc) => {
    if (doc.image && !doc.image.toLowerCase().includes('placehold')) {
      return doc.image;
    }
    if (doc.name && doctorPhotos[doc.name]) {
      return doctorPhotos[doc.name];
    }
    return defaultDoctorPhoto;
  };

  function DoctorsApp() {
    const [doctors, setDoctors] = useState([]);
    const [loading, setLoading] = useState(true);
    const [filter, setFilter] = useState("All");

    useEffect(() => {
      // Fetch doctors from API
      fetch(`${API_URL}/doctors`)
        .then(res => res.json())
        .then(result => {
          if (result.success && result.data.doctors) {
            setDoctors(result.data.doctors);
          }
          setLoading(false);
        })
        .catch(error => {
          console.error('Error loading doctors:', error);
          setLoading(false);
        });
    }, []);

    const specialties = ["All", ...new Set(doctors.map(d => d.specialty))];
    const filteredDoctors = filter === "All" ? doctors : doctors.filter(d => d.specialty === filter);

    if (loading) {
      return e("div", {style: {textAlign: "center", padding: "40px"}}, "Loading doctors...");
    }

    if (doctors.length === 0) {
      return e("div", {style: {textAlign: "center", padding: "40px"}}, "No doctors available.");
    }

    // Filter buttons
    const filterButtons = e("div", {className: "filter-buttons"},
      specialties.map(spec =>
        e("button", {key: spec, onClick: () => setFilter(spec)}, spec)
      )
    );

    // Doctor cards
    const doctorCards = e("div", {className: "doctor-grid"},
      filteredDoctors.map((doc) =>
        e("div", {key: doc._id, className: "doctor-card"},
          e("img", {src: resolveDoctorImage(doc), alt: doc.name}),
          e("h3", null, doc.name),
          e("p", null, doc.specialty),
          doc.bio ? e("p", {style: {fontSize: "14px", color: "#666", marginTop: "10px"}}, doc.bio) : null
        )
      )
    );

    return e("div", null, filterButtons, doctorCards);
  }

  ReactDOM.render(e(DoctorsApp), document.getElementById("doctors-app"));
</script>
<script src="inject-chatbot.js"></script>
<!-- Chatbot Widget -->
<div id="chatbot-icon">ðŸ’¬</div>

<div id="chatbot-window">
    <div class="chatbot-header">Smile Dental Support</div>
    <div class="chatbot-messages"></div>
    <div class="chatbot-input">
        <input type="text" id="chatbot-text" placeholder="Type your message...">
        <button id="chatbot-send">Send</button>
    </div>
</div>

<script src="chatbot.js"></script>
<script src="inject-chatbot.js"></script>

</body>
</html>
